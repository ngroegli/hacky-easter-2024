# Challenge "moduless"
![Banner Image](banner.jpg)

Can you decrypt me even without the modulus?

[problem.py](problem.py)

    import os
    from Crypto.Util.number import bytes_to_long, getPrime

    flag = os.getenvb(b"FLAG", b"he2024{fake}")
    assert flag.startswith(b"he2024{")

    m = bytes_to_long(flag)
    e = 0x10001
    p = getPrime(1024)
    q = getPrime(1024)
    n = p * q
    e = 65537
    phi = (p - 1) * (q - 1)
    d = pow(e, -1, phi)
    c = pow(m, e, n)

    print(f"e={e}")
    print(f"d={d}")
    print(f"hint_1={n - p}")
    print(f"hint_2={n - q}")
    print(f"c={c}")

    # output:
    # e=65537
    # d=108558249913654912965940302330463677659522327849752040249154983537931376711447753446078750459585068929061255563115321514107583357553375511879499468302459674778888941298684123550665943662956973368472434636899177211390575049269298954055740191242891907815891881074808494461835202709340654804790036874512758297194884778457538655665389842207203276000134877032836449478050322547852636564447336587949060158710830910425415789299719726199747636954120947724281386286626712561093374518507186661634721441026468041965091952487426455334066534862315923969845098027755755254715248428307745802890502029004449910036589111577136508145
    # hint_1=17061347780794249474937241232210067248853992326832612618246691021883473946134655677687441412157857703606444858129229798729181511999941417079248816916398800254158380205975686822877683332947748593883879973137797066913439129505904185975901786363274357224292820647481353241115812182163209817605574692194107051614650879245007286513127155460653132782119052901592516408114681455884212579226838379050354351979274017290886704282949858854855220545880052711872903284127358620618442660935241175277762438290440049748381402411449900120675924310471041887374487007916064485523648828943063195915214058020064461558868092911435089696088
    # hint_2=17061347780794249474937241232210067248853992326832612618246691021883473946134655677687441412157857703606444858129229798729181511999941417079248816916398800254158380205975686822877683332947748593883879973137797066913439129505904185975901786363274357224292820647481353241115812182163209817605574692194107051614682608366033433427655544056745556231593264049326018746703896654050234167841676926759637292807314933999966217282511228601089336295804775690349998659758021221369291834448080631738623473608907605109479463903233113943877434062712654852684276670025876108200973499112716384186485697596614301411957746226430962874694
    # c=14771953974869185325753989999306439169443459281017081802044481705032517760143246701952224108615433676555537192461592401710821963371007536567639647832688058381891594635660859018696254198047688405300791235710434996224199879812976316080274952979341960888489269818275411609645795086978322948402441951067219638588493452491788331610154636140788429371883451252588276364444451828866264706502965568460521644194954212456499395773412419744293595190319748377663678851564473399009986610885340941400903567168569899086596357735279151544561157005272580423383179382044165112576721925333630920881944840019797400553640581402786291466801



# Solution
First, we need to find p and q. For them we can use the following information:

    n = p * q
    hint_1 (known) -> h1 = n - p
    hint_2 (known) -> h2 = n - q

With this, we can make the following transformation:

    h1 + p = n
    h2 + q = n

    n = p * q   =>  
        h1 + p = p * q  =>  q = (h1 + p) / p
        h2 + q = p * q
            h2 + ((h1 + p) / p) = p * ((h1 + p) / p)

## The flag
    he2024{}